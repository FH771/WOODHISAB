<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BFIDCWOODHISAB - Password Fixed</title>
<style>
@font-face { font-family: 'Kalpurush'; src: url('https://cdn.jsdelivr.net/gh/at-shovo/bangla-fonts/Kalpurush/Kalpurush.ttf') format('truetype'); }
body{font-family:'Segoe UI',Arial,sans-serif;background:#0f172a;margin:0;color:white;}
header{position:sticky;top:0;background:#020617;padding:10px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #1e293b;}
.card{background:white;padding:15px;border-radius:12px;margin:10px;color:black;position:relative;}
.page{background:white;width:210mm;min-height:296mm;margin:0 auto;padding:10mm 12mm;color:black;position:relative;page-break-after:always;}
.page::before{content:'';position:absolute;inset:0;background:url('logo.png') center/65% no-repeat;opacity:0.05;z-index:0;}
.hidden{display:none;}
input,select{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:8px;margin-bottom:10px;box-sizing:border-box;font-size:18px;}
input:focus{outline:3px solid #22c55e;background:#f0fdf4;}
.summary-box{width:250px;margin-top:20px;border:1.2px solid #000;}
.summary-box div{display:flex;border-bottom:1.2px solid #000;}
.summary-box div:last-child{border-bottom:none;}
.summary-box span{padding:4px 10px;font-size:14px;font-weight:bold;}
.summary-box .label{border-right:1.2px solid #000;flex:1.4;background:#f9f9f9;text-align:left;}
.summary-box .val{flex:1;text-align:center;}
.page-num{position:absolute;bottom:8mm;right:12mm;font-size:12px;font-family:'Kalpurush',sans-serif;}
</style>
</head>
<body>

<div id="loginLayer" style="position:fixed;inset:0;background:#020617;display:flex;align-items:center;justify-content:center;z-index:9999">
<div style="background:#111827;padding:25px;border-radius:14px;width:90%;max-width:320px;text-align:center">
<h2 style="color:white;margin-bottom:20px">BFIDCWOODHISAB</h2>
<input id="uPass" type="password" placeholder="Password" onkeydown="if(event.key==='Enter') handleLogin()">
<button onclick="handleLogin()" style="width:100%;margin-top:10px;padding:12px;background:#22c55e;color:white;font-weight:bold;border:none;border-radius:8px;">LOGIN</button>
</div>
</div>

<div id="appArea" class="hidden">
<header>
<div style="font-size:14px;color:#22c55e;font-weight:bold;">BFIDCWOODHISAB</div>
<div style="display:flex;gap:6px">
<button onclick="document.getElementById('importFile').click()" style="background:#6366f1;color:white;border:none;padding:8px 10px;border-radius:6px;font-size:11px;">üìÇ OPEN</button>
<input type="file" id="importFile" class="hidden" accept=".json" onchange="importData(event)">
<button onclick="downloadBackup()" style="background:#34a853;color:white;border:none;padding:8px 10px;border-radius:6px;font-size:11px;">üíæ BACKUP</button>
<button onclick="exportToWord()" style="background:#2b5797;color:white;border:none;padding:8px 10px;border-radius:6px;font-size:11px;">üìÑ WORD</button>
<button onclick="newWork()" style="background:#ef4444;color:white;border:none;padding:8px 10px;border-radius:6px;font-size:11px;">üóë CLEAR</button>
</div>
</header>

<div class="card">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
<div>‡¶ó‡¶æ‡¶õ ‡¶®‡¶Ç<input id="tree" type="number" value="1" oninput="updatePiece()"></div>
<div>‡¶™‡¶ø‡¶∏ ‡¶®‡¶Ç<input id="piece" readonly style="background:#f1f5f9"></div>
</div>
<div>‡¶ï‡¶æ‡¶†‡ßá‡¶∞ ‡¶ß‡¶∞‡¶£
<select id="woodType" onchange="toggleSizeFields(); render();">
<option value="log">‡¶ó‡ßã‡¶≤ ‡¶ï‡¶æ‡¶† (Round Log)</option>
<option value="size">‡¶∏‡¶æ‡¶á‡¶ú ‡¶ï‡¶æ‡¶† (Sawn Wood)</option>
</select>
</div>

<div id="sizeFields" class="hidden" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
<div>‡¶ö‡¶ì‡ßú‡¶æ<input id="width" type="number" step="any"></div>
<div>‡¶™‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨<input id="thick" type="number" step="any"></div>
</div>

<div id="logField">‡¶¨‡ßá‡ßú (‡¶á‡¶û‡ßç‡¶ö‡¶ø)<input id="v1" type="number" step="any"></div>
<div>‡¶≤‡¶Æ‡ßç‡¶¨‡¶æ (‡¶´‡ßÅ‡¶ü)<input id="v2" type="number" step="any"></div>

<button onclick="addItem()" id="saveBtn" style="width:100%;background:#22c55e;color:white;padding:15px;font-size:18px;border:none;border-radius:8px;font-weight:bold;">‡¶∏‡ßá‡¶≠ (ENTER)</button>
<button onclick="window.print()" style="width:100%;margin-top:10px;background:#475569;color:white;padding:12px;border:none;border-radius:8px;font-weight:bold;">PRINT REPORT</button>
</div>
<div id="printArea"></div>
</div>

<script>
let items=[];
try{const savedData=localStorage.getItem("bfidc_v2_data"); items=savedData?JSON.parse(savedData):[];}catch(e){items=[];}

function handleLogin(){
    const pass = (uPass.value || "").trim();
    if(pass === "0000"){
        // forced show app
        loginLayer.style.display="none";
        appArea.style.display="block";
        render(); updatePiece();
        tree.focus(); tree.select();
    } else {
        alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!");
    }
}

function toggleSizeFields(){let isSize=woodType.value==='size';document.getElementById('sizeFields').classList.toggle('hidden',!isSize);document.getElementById('logField').classList.toggle('hidden',isSize);}
function updatePiece(){let count=items.filter(i=>i.tree==parseInt(tree.value)&&i.type===woodType.value).length;piece.value=count+1;}
function addItem(){let t=parseInt(tree.value),type=woodType.value,v2v=parseFloat(v2.value);let v1v,th,cft;if(type==='log'){v1v=parseFloat(v1.value);if(!t||!v1v||!v2v)return;cft=((v1v/4)**2*v2v)/144;}else{v1v=parseFloat(width.value);th=parseFloat(thick.value);if(!t||!v1v||!th||!v2v)return;cft=(v1v*th*v2v)/144;}items.push({tree:t,type:type,piece:items.filter(i=>i.tree==t&&i.type===type).length+1,v1:v1v,v2:v2v,thick:th||0,cft:parseFloat(cft.toFixed(2))});localStorage.setItem("bfidc_v2_data",JSON.stringify(items));v1.value="";v2.value="";width.value="";thick.value="";render();updatePiece();setTimeout(()=>{tree.focus();tree.select();},50);}
function render(){let currentType=woodType.value;let filteredItems=items.filter(i=>i.type===currentType);if(filteredItems.length===0){document.getElementById("printArea").innerHTML="";return;}let totalCft=filteredItems.reduce((s,i)=>s+i.cft,0);let totalTrees=new Set(filteredItems.map(i=>i.tree)).size;const itemsPerPage=76;const itemsPerCol=38;let html="";for(let p=0;p<filteredItems.length;p+=itemsPerPage){let pageData=filteredItems.slice(p,p+itemsPerPage);let left=pageData.slice(0,itemsPerCol);let right=pageData.slice(itemsPerCol);let th=`<tr><th>‡¶ó‡¶æ‡¶õ/‡¶™‡¶ø‡¶∏</th><th>‡¶Æ‡¶æ‡¶™</th><th>CFT</th></tr>`;html+=`<div class="page">`;if(p===0){html+=`<div class="report-header"><h3>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶¨‡¶® ‡¶∂‡¶ø‡¶≤‡ßç‡¶™ ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶®,</h3><h3>.................. ‡¶∞‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ó‡¶æ‡¶® ‡¶π‡¶§‡ßá ‡¶¨‡¶ø‡¶è‡¶´‡¶Ü‡¶á‡¶°‡¶ø‡¶∏‡¶ø, ‡¶è‡¶≤‡¶™‡¶ø‡¶∏‡¶ø</h3><h3>‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶∞‡ßç‡¶§‡¶®‡¶ï‡ßÉ‡¶§ ‡¶ú‡ßÄ‡¶¨‡¶®‡¶ö‡¶ï‡ßç‡¶∞ ‡¶π‡¶æ‡¶∞‡¶æ‡¶®‡ßã ‡¶∞‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶†‡ßá‡¶∞ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü‡•§</h3></div>`;}html+=`<div class="content-wrapper"><div class="col"><table>${th}${left.map(i=>`<tr><td>${i.tree}/${i.piece}</td><td>${i.type==='size'?i.v1+'"x'+(i.thick||0)+'"x'+i.v2+"'":i.v1+'"x'+i.v2+"'"}</td><td>${i.cft.toFixed(2)}</td></tr>`).join('')}</table></div><div class="col"><table>${th}${right.map(i=>`<tr><td>${i.tree}/${i.piece}</td><td>${i.type==='size'?i.v1+'"x'+(i.thick||0)+'"x'+i.v2+"'":i.v1+'"x'+i.v2+"'"}</td><td>${i.cft.toFixed(2)}</td></tr>`).join('')}</table></div></div>`; if(p+itemsPerPage>=filteredItems.length){html+=`<div class="summary-box"><div><span class="label">‡¶Æ‡ßã‡¶ü ‡¶ó‡¶æ‡¶õ:</span><span class="val">${totalTrees} ‡¶ü‡¶ø</span></div><div><span class="label">‡¶Æ‡ßã‡¶ü ‡¶™‡¶ø‡¶∏:</span><span class="val">${filteredItems.length} ‡¶ü‡¶ø</span></div><div><span class="label">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶ø‡¶è‡¶´‡¶ü‡¶ø:</span><span class="val">${totalCft.toFixed(2)}</span></div></div>`;}html+=`<div class="page-num">‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ: ${Math.floor(p/itemsPerPage)+1}</div></div>`;}document.getElementById("printArea").innerHTML=html;}
function exportToWord(){let content=document.getElementById('printArea').innerHTML;let header="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'></head><body>";let blob=new Blob(['\ufeff',header+content+"</body></html"],{type:'application/msword'});let url=URL.createObjectURL(blob);let link=document.createElement('a');link.href=url;link.download='BFIDC_Report.doc';link.click();}
function downloadBackup(){const blob=new Blob([JSON.stringify(items)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download="BFIDC_Data.json";a.click();}
function importData(event){const file=event.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(e){try{items=JSON.parse(e.target.result);localStorage.setItem("bfidc_v2_data",JSON.stringify(items));render();updatePiece();alert("‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!");}catch(err){alert("‡¶≠‡ßÅ‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤!");}};reader.readAsText(file);}
function newWork(){if(confirm("‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡¶¨‡ßá‡¶®?")){items=[];localStorage.removeItem("bfidc_v2_data");render();updatePiece();}}
</script>
</body>
</html>
